{"version":3,"sources":["../node_modules/.pnpm/@open-iframe-resizer+core@1.2.1/node_modules/@open-iframe-resizer/core/dist/index.js","../src/element/Element.ts"],"sourcesContent":["const g = () => typeof window < \"u\", L = () => window.self !== window.top, m = (e) => e instanceof HTMLIFrameElement, w = (e, t) => {\n  e.document.readyState === \"complete\" ? t() : e.addEventListener(\"load\", t);\n}, y = (e, t) => {\n  t(), e.addEventListener(\"load\", t);\n}, p = (e, t) => {\n  var i, o;\n  const n = ((i = e.contentWindow) == null ? void 0 : i.document.readyState) === \"complete\";\n  return e.src !== \"about:blank\" && ((o = e.contentWindow) == null ? void 0 : o.location.href) !== \"about:blank\" && n ? t() : e.addEventListener(\"load\", t);\n}, v = () => ({ offsetSize: 0, checkOrigin: !0, enableLegacyLibSupport: !1 }), b = (e) => {\n  try {\n    return new URL(e.src).origin === window.location.origin;\n  } catch {\n    return !1;\n  }\n}, I = (e) => {\n  try {\n    const t = new URL(e.src).origin;\n    if (t !== \"about:blank\")\n      return t;\n  } catch {\n  }\n  return null;\n}, R = (e) => (Object.keys(e).forEach((t) => e[t] === void 0 && delete e[t]), e), h = (e) => {\n  const { height: t } = e.documentElement.getBoundingClientRect();\n  return Math.ceil(t);\n};\nfunction z(e) {\n  y(\n    e,\n    () => {\n      var t;\n      return (t = e.contentWindow) == null ? void 0 : t.postMessage(\"[iFrameSizer]ID:0:false:false:32:true:true::auto:::0:false:child:auto:true:::true:::false\", \"*\");\n    }\n  );\n}\nfunction O(e) {\n  if (typeof e.data == \"string\" && e.data.startsWith(\"[iFrameSizer]\")) {\n    const [t, n] = e.data.split(\":\"), r = +n;\n    return r > 0 ? r : null;\n  }\n  return null;\n}\nconst a = g() ? M() : null;\nlet l = [];\nconst D = (e, t) => {\n  if (!g())\n    return [];\n  const n = { ...v(), ...R(e ?? {}) }, r = S(t), i = E(n, r);\n  return r.map((o) => {\n    const s = { iframe: o, settings: n, interactionState: { isHovered: !1 } }, d = C(s, i);\n    return l.push(s), {\n      unsubscribe: () => {\n        d(), l = l.filter((u) => u.iframe !== o);\n      }\n    };\n  });\n};\nfunction S(e) {\n  return typeof e == \"string\" ? Array.from(document.querySelectorAll(e)).filter(m) : e ? m(e) ? [e] : [] : Array.from(document.getElementsByTagName(\"iframe\"));\n}\nfunction E(e, t) {\n  if (Array.isArray(e.checkOrigin))\n    return e.checkOrigin;\n  if (!e.checkOrigin)\n    return [];\n  const n = [];\n  for (const r of t) {\n    const i = I(r);\n    i && n.push(i);\n  }\n  return n;\n}\nfunction C(e, t) {\n  const n = b(e.iframe) ? B(e) : k(e, t), r = H(e);\n  return () => {\n    n(), r();\n  };\n}\nfunction k(e, t) {\n  const { iframe: n, settings: r } = e, i = (o) => {\n    var u;\n    const s = !r.checkOrigin || t.includes(o.origin);\n    if (!(!(n.contentWindow === o.source) || !s)) {\n      if (((u = o.data) == null ? void 0 : u.type) === \"iframe-resized\") {\n        const { height: c } = o.data;\n        c && f({ newHeight: c, registeredElement: e });\n        return;\n      }\n      if (r.enableLegacyLibSupport) {\n        const c = O(o);\n        c !== null && f({ newHeight: c, registeredElement: e });\n        return;\n      }\n    }\n  };\n  return window.addEventListener(\"message\", i), r.enableLegacyLibSupport && z(n), () => window.removeEventListener(\"message\", i);\n}\nfunction B({ iframe: e }) {\n  const t = () => {\n    var r;\n    const n = (r = e.contentDocument) == null ? void 0 : r.body;\n    n && (a == null || a.observe(n));\n  };\n  return p(e, t), () => {\n    var n;\n    (n = e.contentDocument) != null && n.body && (a == null || a.unobserve(e.contentDocument.body)), e.removeEventListener(\"load\", t);\n  };\n}\nfunction H({ iframe: e, interactionState: t }) {\n  const n = () => {\n    t.isHovered = !0;\n  }, r = () => {\n    t.isHovered = !1;\n  };\n  return e.addEventListener(\"mouseenter\", n), e.addEventListener(\"mouseleave\", r), () => {\n    e.removeEventListener(\"mouseenter\", n), e.removeEventListener(\"mouseleave\", r);\n  };\n}\nfunction M() {\n  const e = ({ target: t }) => {\n    const n = l.find((o) => {\n      var s;\n      return ((s = o.iframe.contentDocument) == null ? void 0 : s.body) === t;\n    });\n    if (!n)\n      return;\n    const { iframe: r } = n;\n    if (!r.contentDocument)\n      return;\n    const i = h(r.contentDocument);\n    i && f({ newHeight: i, registeredElement: n });\n  };\n  return new ResizeObserver((t) => t.forEach(e));\n}\nfunction f({ registeredElement: e, newHeight: t }) {\n  const { iframe: n, settings: r, interactionState: i } = e, o = n.getBoundingClientRect(), s = t + r.offsetSize;\n  if (n.style.height = `${s}px`, !r.onIframeResize)\n    return;\n  const d = {\n    iframe: n,\n    settings: { ...r },\n    interactionState: { ...i },\n    previousRenderState: { rect: o },\n    nextRenderState: { rect: n.getBoundingClientRect() }\n  };\n  r.onIframeResize(d);\n}\nW();\nfunction W() {\n  !g() || !L() || w(window, () => {\n    const e = () => {\n      const n = {\n        type: \"iframe-resized\",\n        width: document.documentElement.scrollWidth,\n        height: h(document)\n      };\n      window.parent.postMessage(n, \"*\");\n    };\n    new ResizeObserver(e).observe(document.body);\n  });\n}\nconst A = ({ previousRenderState: e, nextRenderState: t, interactionState: n }) => {\n  n.isHovered && window.scrollBy(0, t.rect.bottom - e.rect.bottom);\n};\nexport {\n  D as initialize,\n  W as initializeChildListener,\n  A as updateParentScrollOnResize\n};\n","import { initialize } from \"../../node_modules/@open-iframe-resizer/core/dist/index.js\"\nimport Serverbench from \"../Serverbench.js\"\n\nexport default class Element {\n\n    private readonly client: Serverbench\n    private dark: boolean\n    private background: boolean\n    private readonly path: string\n    private readonly args: Record<string, string | string[] | undefined>\n    private eventListeners: { [key: string]: Function[] } = {};\n\n    constructor(client: Serverbench, path: string, args: Record<string, string | string[] | undefined> = {}, dark: boolean = false, background: boolean = false) {\n        this.client = client\n        this.dark = dark\n        this.background = background\n        this.path = path\n        this.args = args\n        window.addEventListener('message', this.handleMessage.bind(this));\n    }\n\n    setDark(dark: boolean) {\n        this.dark = dark\n        return this\n    }\n\n    setBackground(background: boolean) {\n        this.background = background\n        return this\n    }\n\n    async mount(element: HTMLElement) {\n        const queryParams = new URLSearchParams()\n        queryParams.set('clientId', this.client.clientId)\n        queryParams.set('clientSecret', this.client.clientSecret)\n        queryParams.set('origin', window.location.href)\n        queryParams.set('allow', \"payment\") // apple pay support\n        if (this.client.test) queryParams.set('test', 'true')\n        if (this.dark) queryParams.set('dark', 'true')\n        if (this.background) queryParams.set('background', 'true')\n        for (const key in this.args) {\n            const value = this.args[key]\n            if (Array.isArray(value)) {\n                if (value.length > 0) queryParams.set(key, value.join(','))\n            } else if (value != undefined) {\n                queryParams.set(key, value)\n            }\n        }\n\n        element.innerHTML = '';\n\n        const iframe = document.createElement('iframe');\n        iframe.src = `https://safe.serverbench.io${this.path}?${queryParams.toString()}`;\n        iframe.style.width = '100%';\n        iframe.style.height = '0'\n        iframe.style.border = 'none';\n        iframe.style.overflowY = 'hidden';\n        iframe.frameBorder = '0';\n\n        const appended = element.appendChild(iframe);\n        initialize({}, appended);\n        return this\n    }\n\n    private handleMessage(event: MessageEvent) {\n        if (event.origin !== 'https://safe.serverbench.io') return;\n        const data = event.data;\n        if (data.from === 'serverbench' && data.event) {\n            this.triggerEvent(data.event);\n        }\n    }\n\n    private triggerEvent(eventName: string) {\n        const listeners = this.eventListeners[eventName];\n        if (listeners) {\n            listeners.forEach(callback => callback());\n        }\n    }\n\n    public addEventListener(eventName: string, callback: Function) {\n        if (!this.eventListeners[eventName]) {\n            this.eventListeners[eventName] = [];\n        }\n        this.eventListeners[eventName].push(callback);\n        return this;\n    }\n\n}"],"mappings":"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","names":["g","L","m","w","p","i","o","n","v","b","I","R","h","z","O","a","M","l","D","S","E","s","d","C","u","B","k","H","c","f","r","Element","client","path","args","dark","background","element","queryParams","key","value","iframe","appended","D","event","data","eventName","listeners","callback"]}