{"version":3,"sources":["../../src/store/Store.ts","../../node_modules/.pnpm/@open-iframe-resizer+core@1.2.1/node_modules/@open-iframe-resizer/core/dist/index.js","../../src/element/Element.ts"],"sourcesContent":["import Element from \"../element/Element.js\";\r\nimport Member from \"../Member.js\";\r\nimport type Serverbench from \"../Serverbench.js\";\r\nimport IDiscount from \"./IDiscount.js\";\r\nimport ISkuPrice from \"./ISkuPrice.js\";\r\nimport type IStore from \"./IStore.js\";\r\n\r\nexport default class Store {\r\n\r\n    private client: Serverbench\r\n\r\n    constructor(client: Serverbench) {\r\n        this.client = client\r\n    }\r\n\r\n    async get(username?: string, eid?: string) {\r\n        return (await this.client.post('community', '/store/view', {\r\n            username,\r\n            eid\r\n        })) as IStore\r\n    }\r\n\r\n    checkout(prices: ISkuPrice[], discounts: IDiscount[], member: Member) {\r\n        return new Element(\r\n            this.client,\r\n            '/community/checkout',\r\n            {\r\n                prices: prices.map(price => price.id).join(','),\r\n                discounts: discounts.map(discount => discount.id).join(','),\r\n                member: member.id\r\n            }\r\n        )\r\n    }\r\n\r\n}","const g = () => typeof window < \"u\", L = () => window.self !== window.top, m = (e) => e instanceof HTMLIFrameElement, w = (e, t) => {\n  e.document.readyState === \"complete\" ? t() : e.addEventListener(\"load\", t);\n}, y = (e, t) => {\n  t(), e.addEventListener(\"load\", t);\n}, p = (e, t) => {\n  var i, o;\n  const n = ((i = e.contentWindow) == null ? void 0 : i.document.readyState) === \"complete\";\n  return e.src !== \"about:blank\" && ((o = e.contentWindow) == null ? void 0 : o.location.href) !== \"about:blank\" && n ? t() : e.addEventListener(\"load\", t);\n}, v = () => ({ offsetSize: 0, checkOrigin: !0, enableLegacyLibSupport: !1 }), b = (e) => {\n  try {\n    return new URL(e.src).origin === window.location.origin;\n  } catch {\n    return !1;\n  }\n}, I = (e) => {\n  try {\n    const t = new URL(e.src).origin;\n    if (t !== \"about:blank\")\n      return t;\n  } catch {\n  }\n  return null;\n}, R = (e) => (Object.keys(e).forEach((t) => e[t] === void 0 && delete e[t]), e), h = (e) => {\n  const { height: t } = e.documentElement.getBoundingClientRect();\n  return Math.ceil(t);\n};\nfunction z(e) {\n  y(\n    e,\n    () => {\n      var t;\n      return (t = e.contentWindow) == null ? void 0 : t.postMessage(\"[iFrameSizer]ID:0:false:false:32:true:true::auto:::0:false:child:auto:true:::true:::false\", \"*\");\n    }\n  );\n}\nfunction O(e) {\n  if (typeof e.data == \"string\" && e.data.startsWith(\"[iFrameSizer]\")) {\n    const [t, n] = e.data.split(\":\"), r = +n;\n    return r > 0 ? r : null;\n  }\n  return null;\n}\nconst a = g() ? M() : null;\nlet l = [];\nconst D = (e, t) => {\n  if (!g())\n    return [];\n  const n = { ...v(), ...R(e ?? {}) }, r = S(t), i = E(n, r);\n  return r.map((o) => {\n    const s = { iframe: o, settings: n, interactionState: { isHovered: !1 } }, d = C(s, i);\n    return l.push(s), {\n      unsubscribe: () => {\n        d(), l = l.filter((u) => u.iframe !== o);\n      }\n    };\n  });\n};\nfunction S(e) {\n  return typeof e == \"string\" ? Array.from(document.querySelectorAll(e)).filter(m) : e ? m(e) ? [e] : [] : Array.from(document.getElementsByTagName(\"iframe\"));\n}\nfunction E(e, t) {\n  if (Array.isArray(e.checkOrigin))\n    return e.checkOrigin;\n  if (!e.checkOrigin)\n    return [];\n  const n = [];\n  for (const r of t) {\n    const i = I(r);\n    i && n.push(i);\n  }\n  return n;\n}\nfunction C(e, t) {\n  const n = b(e.iframe) ? B(e) : k(e, t), r = H(e);\n  return () => {\n    n(), r();\n  };\n}\nfunction k(e, t) {\n  const { iframe: n, settings: r } = e, i = (o) => {\n    var u;\n    const s = !r.checkOrigin || t.includes(o.origin);\n    if (!(!(n.contentWindow === o.source) || !s)) {\n      if (((u = o.data) == null ? void 0 : u.type) === \"iframe-resized\") {\n        const { height: c } = o.data;\n        c && f({ newHeight: c, registeredElement: e });\n        return;\n      }\n      if (r.enableLegacyLibSupport) {\n        const c = O(o);\n        c !== null && f({ newHeight: c, registeredElement: e });\n        return;\n      }\n    }\n  };\n  return window.addEventListener(\"message\", i), r.enableLegacyLibSupport && z(n), () => window.removeEventListener(\"message\", i);\n}\nfunction B({ iframe: e }) {\n  const t = () => {\n    var r;\n    const n = (r = e.contentDocument) == null ? void 0 : r.body;\n    n && (a == null || a.observe(n));\n  };\n  return p(e, t), () => {\n    var n;\n    (n = e.contentDocument) != null && n.body && (a == null || a.unobserve(e.contentDocument.body)), e.removeEventListener(\"load\", t);\n  };\n}\nfunction H({ iframe: e, interactionState: t }) {\n  const n = () => {\n    t.isHovered = !0;\n  }, r = () => {\n    t.isHovered = !1;\n  };\n  return e.addEventListener(\"mouseenter\", n), e.addEventListener(\"mouseleave\", r), () => {\n    e.removeEventListener(\"mouseenter\", n), e.removeEventListener(\"mouseleave\", r);\n  };\n}\nfunction M() {\n  const e = ({ target: t }) => {\n    const n = l.find((o) => {\n      var s;\n      return ((s = o.iframe.contentDocument) == null ? void 0 : s.body) === t;\n    });\n    if (!n)\n      return;\n    const { iframe: r } = n;\n    if (!r.contentDocument)\n      return;\n    const i = h(r.contentDocument);\n    i && f({ newHeight: i, registeredElement: n });\n  };\n  return new ResizeObserver((t) => t.forEach(e));\n}\nfunction f({ registeredElement: e, newHeight: t }) {\n  const { iframe: n, settings: r, interactionState: i } = e, o = n.getBoundingClientRect(), s = t + r.offsetSize;\n  if (n.style.height = `${s}px`, !r.onIframeResize)\n    return;\n  const d = {\n    iframe: n,\n    settings: { ...r },\n    interactionState: { ...i },\n    previousRenderState: { rect: o },\n    nextRenderState: { rect: n.getBoundingClientRect() }\n  };\n  r.onIframeResize(d);\n}\nW();\nfunction W() {\n  !g() || !L() || w(window, () => {\n    const e = () => {\n      const n = {\n        type: \"iframe-resized\",\n        width: document.documentElement.scrollWidth,\n        height: h(document)\n      };\n      window.parent.postMessage(n, \"*\");\n    };\n    new ResizeObserver(e).observe(document.body);\n  });\n}\nconst A = ({ previousRenderState: e, nextRenderState: t, interactionState: n }) => {\n  n.isHovered && window.scrollBy(0, t.rect.bottom - e.rect.bottom);\n};\nexport {\n  D as initialize,\n  W as initializeChildListener,\n  A as updateParentScrollOnResize\n};\n","import { initialize } from \"../../node_modules/@open-iframe-resizer/core/dist/index.js\"\r\nimport Serverbench from \"../Serverbench.js\"\r\n\r\nexport default class Element {\r\n\r\n    private readonly client: Serverbench\r\n    private dark: boolean\r\n    private background: boolean\r\n    private readonly path: string\r\n    private readonly args: Record<string, string | string[]>\r\n\r\n    constructor(client: Serverbench, path: string, args: Record<string, string | string[]> = {}, dark: boolean = false, background: boolean = false) {\r\n        this.client = client\r\n        this.dark = dark\r\n        this.background = background\r\n        this.path = path\r\n        this.args = args\r\n    }\r\n\r\n    setDark(dark: boolean) {\r\n        this.dark = dark\r\n        return this\r\n    }\r\n\r\n    setBackground(background: boolean) {\r\n        this.background = background\r\n        return this\r\n    }\r\n\r\n    async mount(element: HTMLElement) {\r\n        const queryParams = new URLSearchParams()\r\n        queryParams.set('clientId', this.client.clientId)\r\n        queryParams.set('clientSecret', this.client.clientSecret)\r\n        if (this.dark) queryParams.set('dark', 'true')\r\n        if (this.background) queryParams.set('background', 'true')\r\n        for (const key in this.args) {\r\n            const value = this.args[key]\r\n            if (Array.isArray(value)) {\r\n                queryParams.set(key, value.join(','))\r\n            } else {\r\n                queryParams.set(key, value)\r\n            }\r\n        }\r\n        const iframe = document.createElement('iframe');\r\n        iframe.src = `https://safe.serverbench.io${this.path}?${queryParams.toString()}`;\r\n        iframe.style.width = '100%';\r\n        const appended = element.appendChild(iframe);\r\n        initialize({}, appended);\r\n        return this\r\n    }\r\n\r\n}"],"mappings":"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","names":["e"]}