var f=()=>typeof window<"u",b=()=>window.self!==window.top,g=e=>e instanceof HTMLIFrameElement,p=(e,t)=>{e.document.readyState==="complete"?t():e.addEventListener("load",t)},w=(e,t)=>{t(),e.addEventListener("load",t)},y=(e,t)=>{var n,r;let i=((n=e.contentWindow)==null?void 0:n.document.readyState)==="complete";return e.src!=="about:blank"&&((r=e.contentWindow)==null?void 0:r.location.href)!=="about:blank"&&i?t():e.addEventListener("load",t)},S=()=>({offsetSize:0,checkOrigin:!0,enableLegacyLibSupport:!1}),k=e=>{try{return new URL(e.src).origin===window.location.origin}catch{return!1}},L=e=>{try{let t=new URL(e.src).origin;if(t!=="about:blank")return t}catch{}return null},E=e=>(Object.keys(e).forEach(t=>e[t]===void 0&&delete e[t]),e),h=e=>{let{height:t}=e.documentElement.getBoundingClientRect();return Math.ceil(t)};function R(e){w(e,()=>{var t;return(t=e.contentWindow)==null?void 0:t.postMessage("[iFrameSizer]ID:0:false:false:32:true:true::auto:::0:false:child:auto:true:::true:::false","*")})}function z(e){if(typeof e.data=="string"&&e.data.startsWith("[iFrameSizer]")){let[t,n]=e.data.split(":"),r=+n;return r>0?r:null}return null}var u=f()?W():null,d=[],v=(e,t)=>{if(!f())return[];let n={...S(),...E(e??{})},r=H(t),i=O(n,r);return r.map(o=>{let s={iframe:o,settings:n,interactionState:{isHovered:!1}},c=D(s,i);return d.push(s),{unsubscribe:()=>{c(),d=d.filter(a=>a.iframe!==o)}}})};function H(e){return typeof e=="string"?Array.from(document.querySelectorAll(e)).filter(g):e?g(e)?[e]:[]:Array.from(document.getElementsByTagName("iframe"))}function O(e,t){if(Array.isArray(e.checkOrigin))return e.checkOrigin;if(!e.checkOrigin)return[];let n=[];for(let r of t){let i=L(r);i&&n.push(i)}return n}function D(e,t){let n=k(e.iframe)?B(e):A(e,t),r=I(e);return()=>{n(),r()}}function A(e,t){let{iframe:n,settings:r}=e,i=o=>{var s;let c=!r.checkOrigin||t.includes(o.origin);if(!(n.contentWindow!==o.source||!c)){if(((s=o.data)==null?void 0:s.type)==="iframe-resized"){let{height:a}=o.data;a&&l({newHeight:a,registeredElement:e});return}if(r.enableLegacyLibSupport){let a=z(o);a!==null&&l({newHeight:a,registeredElement:e});return}}};return window.addEventListener("message",i),r.enableLegacyLibSupport&&R(n),()=>window.removeEventListener("message",i)}function B({iframe:e}){let t=()=>{var n;let r=(n=e.contentDocument)==null?void 0:n.body;r&&u?.observe(r)};return y(e,t),()=>{var n;(n=e.contentDocument)!=null&&n.body&&u?.unobserve(e.contentDocument.body),e.removeEventListener("load",t)}}function I({iframe:e,interactionState:t}){let n=()=>{t.isHovered=!0},r=()=>{t.isHovered=!1};return e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",r),()=>{e.removeEventListener("mouseenter",n),e.removeEventListener("mouseleave",r)}}function W(){let e=({target:t})=>{let n=d.find(o=>{var s;return((s=o.iframe.contentDocument)==null?void 0:s.body)===t});if(!n)return;let{iframe:r}=n;if(!r.contentDocument)return;let i=h(r.contentDocument);i&&l({newHeight:i,registeredElement:n})};return new ResizeObserver(t=>t.forEach(e))}function l({registeredElement:e,newHeight:t}){let{iframe:n,settings:r,interactionState:i}=e,o=n.getBoundingClientRect(),s=t+r.offsetSize;if(n.style.height=`${s}px`,!r.onIframeResize)return;let c={iframe:n,settings:{...r},interactionState:{...i},previousRenderState:{rect:o},nextRenderState:{rect:n.getBoundingClientRect()}};r.onIframeResize(c)}C();function C(){!f()||!b()||p(window,()=>{let e=()=>{let t={type:"iframe-resized",width:document.documentElement.scrollWidth,height:h(document)};window.parent.postMessage(t,"*")};new ResizeObserver(e).observe(document.body)})}var m=class{constructor(t,n,r={},i=!1,o=!1){this.client=t,this.dark=i,this.background=o,this.path=n,this.args=r}setDark(t){return this.dark=t,this}setBackground(t){return this.background=t,this}async mount(t){let n=new URLSearchParams;n.set("clientId",this.client.clientId),n.set("clientSecret",this.client.clientSecret),n.set("origin",window.location.href),this.dark&&n.set("dark","true"),this.background&&n.set("background","true");for(let o in this.args){let s=this.args[o];Array.isArray(s)?n.set(o,s.join(",")):n.set(o,s)}let r=document.createElement("iframe");r.src=`https://safe.serverbench.io${this.path}?${n.toString()}`,r.style.width="100%";let i=t.appendChild(r);return v({},i),this}};export{m as a};
//# sourceMappingURL=chunk-B3VJ2OR7.js.map