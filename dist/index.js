var g=()=>typeof window<"u",S=()=>window.self!==window.top,v=e=>e instanceof HTMLIFrameElement,w=(e,t)=>{e.document.readyState==="complete"?t():e.addEventListener("load",t)},k=(e,t)=>{t(),e.addEventListener("load",t)},E=(e,t)=>{var n,r;let i=((n=e.contentWindow)==null?void 0:n.document.readyState)==="complete";return e.src!=="about:blank"&&((r=e.contentWindow)==null?void 0:r.location.href)!=="about:blank"&&i?t():e.addEventListener("load",t)},I=()=>({offsetSize:0,checkOrigin:!0,enableLegacyLibSupport:!1}),L=e=>{try{return new URL(e.src).origin===window.location.origin}catch{return!1}},R=e=>{try{let t=new URL(e.src).origin;if(t!=="about:blank")return t}catch{}return null},z=e=>(Object.keys(e).forEach(t=>e[t]===void 0&&delete e[t]),e),b=e=>{let{height:t}=e.documentElement.getBoundingClientRect();return Math.ceil(t)};function D(e){k(e,()=>{var t;return(t=e.contentWindow)==null?void 0:t.postMessage("[iFrameSizer]ID:0:false:false:32:true:true::auto:::0:false:child:auto:true:::true:::false","*")})}function H(e){if(typeof e.data=="string"&&e.data.startsWith("[iFrameSizer]")){let[t,n]=e.data.split(":"),r=+n;return r>0?r:null}return null}var f=g()?P():null,h=[],y=(e,t)=>{if(!g())return[];let n={...I(),...z(e??{})},r=O(t),i=x(n,r);return r.map(o=>{let s={iframe:o,settings:n,interactionState:{isHovered:!1}},d=C(s,i);return h.push(s),{unsubscribe:()=>{d(),h=h.filter(a=>a.iframe!==o)}}})};function O(e){return typeof e=="string"?Array.from(document.querySelectorAll(e)).filter(v):e?v(e)?[e]:[]:Array.from(document.getElementsByTagName("iframe"))}function x(e,t){if(Array.isArray(e.checkOrigin))return e.checkOrigin;if(!e.checkOrigin)return[];let n=[];for(let r of t){let i=R(r);i&&n.push(i)}return n}function C(e,t){let n=L(e.iframe)?M(e):A(e,t),r=j(e);return()=>{n(),r()}}function A(e,t){let{iframe:n,settings:r}=e,i=o=>{var s;let d=!r.checkOrigin||t.includes(o.origin);if(!(n.contentWindow!==o.source||!d)){if(((s=o.data)==null?void 0:s.type)==="iframe-resized"){let{height:a}=o.data;a&&p({newHeight:a,registeredElement:e});return}if(r.enableLegacyLibSupport){let a=H(o);a!==null&&p({newHeight:a,registeredElement:e});return}}};return window.addEventListener("message",i),r.enableLegacyLibSupport&&D(n),()=>window.removeEventListener("message",i)}function M({iframe:e}){let t=()=>{var n;let r=(n=e.contentDocument)==null?void 0:n.body;r&&f?.observe(r)};return E(e,t),()=>{var n;(n=e.contentDocument)!=null&&n.body&&f?.unobserve(e.contentDocument.body),e.removeEventListener("load",t)}}function j({iframe:e,interactionState:t}){let n=()=>{t.isHovered=!0},r=()=>{t.isHovered=!1};return e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",r),()=>{e.removeEventListener("mouseenter",n),e.removeEventListener("mouseleave",r)}}function P(){let e=({target:t})=>{let n=h.find(o=>{var s;return((s=o.iframe.contentDocument)==null?void 0:s.body)===t});if(!n)return;let{iframe:r}=n;if(!r.contentDocument)return;let i=b(r.contentDocument);i&&p({newHeight:i,registeredElement:n})};return new ResizeObserver(t=>t.forEach(e))}function p({registeredElement:e,newHeight:t}){let{iframe:n,settings:r,interactionState:i}=e,o=n.getBoundingClientRect(),s=t+r.offsetSize;if(n.style.height=`${s}px`,!r.onIframeResize)return;let d={iframe:n,settings:{...r},interactionState:{...i},previousRenderState:{rect:o},nextRenderState:{rect:n.getBoundingClientRect()}};r.onIframeResize(d)}$();function $(){!g()||!S()||w(window,()=>{let e=()=>{let t={type:"iframe-resized",width:document.documentElement.scrollWidth,height:b(document)};window.parent.postMessage(t,"*")};new ResizeObserver(e).observe(document.body)})}var u=class{constructor(t,n,r={},i=!1,o=!1){this.client=t,this.dark=i,this.background=o,this.path=n,this.args=r}setDark(t){return this.dark=t,this}setBackground(t){return this.background=t,this}async mount(t){let n=new URLSearchParams;n.set("clientId",this.client.clientId),n.set("clientSecret",this.client.clientSecret),this.dark&&n.set("dark","true"),this.background&&n.set("background","true");for(let o in this.args){let s=this.args[o];Array.isArray(s)?n.set(o,s.join(",")):n.set(o,s)}let r=document.createElement("iframe");r.src=`https://safe.serverbench.io${this.path}?${n.toString()}`,r.style.width="100%";let i=t.appendChild(r);return y({},i),this}};var l=class{constructor(t){this.client=t}async get(t,n){return await this.client.post("community","/store/view",{username:t,eid:n})}checkout(t,n,r){return new u(this.client,"/community/checkout",{prices:t.map(i=>i.id).join(","),discounts:n.map(i=>i.id).join(","),member:r.id})}};var c=class c{constructor(t,n,r){this.clientId=t,this.clientSecret=n,this.test=r}static get(t,n,r=!1){return(!c.instance||c.instance.clientId!==t||c.instance.clientSecret!==n||c.instance.test!==r)&&(c.instance=new c(t,n,r)),c.instance}get store(){return new l(this)}async fetch(t,n,r){let i=this.test?"https://dev.serverbench.io":"https://api.serverbench.io",o=new Headers({authorization:`ApiKey ${this.clientSecret}`});return r&&o.set("Content-Type","application/json"),(await fetch(`${i}/${t}/${this.clientId}${n}`,{headers:o,method:r?"POST":"GET",body:r?JSON.stringify(r):void 0})).json()}async get(t,n){return this.fetch(t,n)}async post(t,n,r={}){return this.fetch(t,n,r)}};c.instance=null;var m=c;var Q=m;export{u as Element,l as Store,Q as default};
//# sourceMappingURL=index.js.map