"use strict";Object.defineProperty(exports, "__esModule", {value: true});var _chunkX3RFL5ZRcjs = require('./chunk-X3RFL5ZR.cjs');var _chunkEDOIUX46cjs = require('./chunk-EDOIUX46.cjs');var s=class s{constructor(t,n,e){this.clientId=t,this.clientSecret=n,this.test=e}static get(t,n,e=!1){return(!s.instance||s.instance.clientId!==t||s.instance.clientSecret!==n||s.instance.test!==e)&&(s.instance=new s(t,n,e)),s.instance}get store(){return new (0, _chunkEDOIUX46cjs.a)(this)}get voting(){return new (0, _chunkX3RFL5ZRcjs.a)(this)}async fetch(t,n,e){let i=this.test?"https://dev.serverbench.io":"https://api.beta.serverbench.io",r=new Headers({authorization:`ApiKey ${this.clientSecret}`});return e&&r.set("Content-Type","application/json"),(await fetch(`${i}/${t}/${this.clientId}${n}`,{headers:r,method:e?"POST":"GET",body:e?JSON.stringify(e):void 0})).json()}socket(t,n=!1){let e=this.test?"ws://localhost:3030":"wss://stream.beta.serverbench.io",i=new WebSocket(`${e}?${new URLSearchParams({key:this.clientSecret})}`),r=0;return i.onopen=()=>{r=0,i.send(JSON.stringify({action:`community.${this.clientId}.${t}`}))},n||(i.onclose=()=>{r++,setTimeout(()=>{i=this.socket(t,!0).ws},Math.min(1e3*r*5,30*1e3))}),{dispose:()=>{i.onclose=null,i.close()},ws:i}}async get(t,n){return this.fetch(t,n)}async post(t,n,e={}){return this.fetch(t,n,e)}};s.instance=null;var o=s;exports.a = o;
//# sourceMappingURL=chunk-RWLT4VJ2.cjs.map